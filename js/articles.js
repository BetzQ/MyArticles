function formatArticleItem(e){return`<li class="bg-gray-200 p-2 min-h-screen rounded m-5 shadow-md shadow-black relative"> <div class="mt-1 flex justify-end"> <button class="z-10 text-white bg-red-500 py-2 px-3 rounded hover:bg-red-600" data-id="${e._id}"> Delete </button> </div><div class="-mt-8"> <h2 class="text-center font-medium text-xl">${e.title}</h2> <p class="mt-3 text-base">${e.content}</p></div></li>`}document.addEventListener("click",e=>{if(e.target.matches("[data-id]")){let t=e.target.getAttribute("data-id"),r=localStorage.getItem("user_id"),i=`https://server-my-articles.vercel.app/users/${r}/articles/${t}`,s=confirm("Are you sure you want to delete this article?");s&&fetch(i,{method:"DELETE"}).then(e=>e.json()).then(t=>{e.target.closest("li").remove()}).catch(e=>console.error(e))}}),window.addEventListener("load",()=>{let e=localStorage.getItem("user_id"),t=`https://server-my-articles.vercel.app/users/${e}`;fetch(t).then(e=>(e.ok||(window.location.href="/"),e.json())).then(e=>{e.user.articles||(window.location.href="/"),document.querySelector(".noAccessAdmin").classList.add("hidden");let t=e.user.articles,r=document.getElementById("list-articles");t.forEach(e=>{let t=formatArticleItem(e);r.insertAdjacentHTML("beforeend",t)})}).catch(e=>console.error(e))});const formArticle=document.getElementById("form-article");function renderArticles(){let e=localStorage.getItem("user_id"),t=`https://server-my-articles.vercel.app/users/${e}`;fetch(t).then(e=>e.json()).then(e=>{let t=e.user.articles,r=document.getElementById("list-articles");for(;r.firstChild;)r.removeChild(r.firstChild);t.forEach(e=>{let t=formatArticleItem(e);r.insertAdjacentHTML("beforeend",t)})}).catch(e=>console.error(e))}function handleLogoutClick(){localStorage.removeItem("user_id"),window.location.href="/"}formArticle.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("input-title"),r=document.getElementById("input-content"),i=DOMPurify.sanitize(t.value.trim()),s=DOMPurify.sanitize(r.value.trim());if(i)t.classList.remove("is-invalid");else{t.classList.add("is-invalid");return}if(s)r.classList.remove("is-invalid");else{r.classList.add("is-invalid");return}let l=localStorage.getItem("user_id"),n=`https://server-my-articles.vercel.app/users/${l}`;fetch(n).then(e=>e.json()).then(e=>{let t=e.user.articles;return fetch(n,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i,content:s,articles:[{title:i,content:s},...t]})})}).then(e=>e.json()).then(e=>{let i=e.user.articles[e.user.articles.length-1],s=formatArticleItem(i),l=document.getElementById("list-articles");l.insertAdjacentHTML("beforeend",s),t.value="",r.value="",renderArticles()}).catch(e=>console.error(e))}),document.getElementById("Logout").addEventListener("click",handleLogoutClick);